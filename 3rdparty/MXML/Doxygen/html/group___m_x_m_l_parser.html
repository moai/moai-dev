<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
  <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
  <TITLE>Micro XML: Micro XML Parser</TITLE>
  <LINK HREF="mxml_style.css" REL="stylesheet" TYPE="text/css">
</HEAD>
<BODY>
<div style="height:146px; width: 100%; background-image: url(images/mxml_header.jpg); background-repeat: no-repeat;">
</div>
<div class="content">
<!-- Generated by Doxygen 1.3.8 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a></div>
<h1>Micro XML Parser<br>
<small>
[<a class="el" href="group___m_x_m_l.html">Micro XML</a>]</small>
</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
The Micro XML parser is implemented in pure c, and can be used without the Micro XML DOM. The parser supports input stream buffering, and provides parsed document information via 3 registered callbacks on the created parser object. 
<p>
<table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="struct_m_x_m_l_parser.html">MXMLParser</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">XMLParser type returned by MXMLParserCreate.  <a href="struct_m_x_m_l_parser.html#_details">More...</a><br></td></tr>
<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef void(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group___m_x_m_l_parser.html#ga0">MXMLStartElementCallback</a> )(void *a_userData, const char *a_name, const char **a_attributes)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parser callback to handle xml start elements  <a href="#ga0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef void(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group___m_x_m_l_parser.html#ga1">MXMLEndElementCallback</a> )(void *a_userData, const char *a_name)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parser callback to handle xml end elements  <a href="#ga1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef void(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group___m_x_m_l_parser.html#ga2">MXMLCharacterDataCallback</a> )(void *a_userData, const char *a_data, size_t a_size, MXMLCharacterDataType a_type)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parser callback to handle xml element data, a_size does not include terminating char  <a href="#ga2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="anchor" name="ga3" doxytag="MXMLParser::MXMLAlloc" ></a>
typedef void *(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group___m_x_m_l_parser.html#ga3">MXMLAlloc</a> )(size_t a_size)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parser alloc callback <br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="anchor" name="ga4" doxytag="MXMLParser::MXMLFree" ></a>
typedef void(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group___m_x_m_l_parser.html#ga4">MXMLFree</a> )(void *a_mem)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parser free callback <br></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="struct_m_x_m_l_parser.html">MXMLParser</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group___m_x_m_l_parser.html#ga5">MXMLParserCreate</a> (<a class="el" href="group___m_x_m_l_parser.html#ga3">MXMLAlloc</a> a_Alloc, <a class="el" href="group___m_x_m_l_parser.html#ga4">MXMLFree</a> a_Free)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">create a micro xml parser  <a href="#ga5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group___m_x_m_l_parser.html#ga6">MXMLParserDestroy</a> (<a class="el" href="struct_m_x_m_l_parser.html">MXMLParser</a> *a_parser)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">destroy a xml parser  <a href="#ga6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>MXMLResult&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group___m_x_m_l_parser.html#ga7">MXMLParserParse</a> (<a class="el" href="struct_m_x_m_l_parser.html">MXMLParser</a> *a_parser, const unsigned char *a_buffer, size_t a_bufferSize, int a_lastBuffer)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse function  <a href="#ga7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="anchor" name="ga8" doxytag="MXMLParser::MXMLParserGetErrorString" ></a>
const char *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group___m_x_m_l_parser.html#ga8">MXMLParserGetErrorString</a> (<a class="el" href="struct_m_x_m_l_parser.html">MXMLParser</a> *a_parser)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">return an error string if MXMLParserParse returned MXML_RESULT_ERROR <br></td></tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="ga2" doxytag="mxml.h::MXMLCharacterDataCallback" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef void(* <a class="el" href="group___m_x_m_l_parser.html#ga2">MXMLCharacterDataCallback</a>)(void *a_userData, const char *a_data, size_t a_size, MXMLCharacterDataType a_type)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parser callback to handle xml element data, a_size does not include terminating char 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>a_userData</em>&nbsp;</td><td>is the user data given to the <a class="el" href="struct_m_x_m_l_parser.html">MXMLParser</a> object </td></tr>
    <tr><td></td><td valign=top><em>a_data</em>&nbsp;</td><td>is the character data for the said node type (UTF8) </td></tr>
    <tr><td></td><td valign=top><em>a_size</em>&nbsp;</td><td>is the size of the data excluding the null terminating char </td></tr>
    <tr><td></td><td valign=top><em>a_type</em>&nbsp;</td><td>is the type of character data </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga1" doxytag="mxml.h::MXMLEndElementCallback" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef void(* <a class="el" href="group___m_x_m_l_parser.html#ga1">MXMLEndElementCallback</a>)(void *a_userData, const char *a_name)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parser callback to handle xml end elements 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>a_userData</em>&nbsp;</td><td>is the user data given to the <a class="el" href="struct_m_x_m_l_parser.html">MXMLParser</a> object </td></tr>
    <tr><td></td><td valign=top><em>a_name</em>&nbsp;</td><td>is the name of the node (UTF8) </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga0" doxytag="mxml.h::MXMLStartElementCallback" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef void(* <a class="el" href="group___m_x_m_l_parser.html#ga0">MXMLStartElementCallback</a>)(void *a_userData, const char *a_name, const char **a_attributes)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parser callback to handle xml start elements 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>a_userData</em>&nbsp;</td><td>is the user data given to the <a class="el" href="struct_m_x_m_l_parser.html">MXMLParser</a> object </td></tr>
    <tr><td></td><td valign=top><em>a_name</em>&nbsp;</td><td>is the name of the node (UTF8) </td></tr>
    <tr><td></td><td valign=top><em>a_attributes</em>&nbsp;</td><td>is an array of attribute name value pairs (UTF8) </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="ga5" doxytag="mxml.h::MXMLParserCreate" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="struct_m_x_m_l_parser.html">MXMLParser</a>* MXMLParserCreate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group___m_x_m_l_parser.html#ga3">MXMLAlloc</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>a_Alloc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="group___m_x_m_l_parser.html#ga4">MXMLFree</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>a_Free</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
create a micro xml parser 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>a_Alloc</em>&nbsp;</td><td>is a memory hook used for all internal memory allocations </td></tr>
    <tr><td></td><td valign=top><em>a_Free</em>&nbsp;</td><td>is a memory hook for freeing all memory allocations </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="struct_m_x_m_l_parser.html">MXMLParser</a> or NULL on error </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga6" doxytag="mxml.h::MXMLParserDestroy" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void MXMLParserDestroy           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_m_x_m_l_parser.html">MXMLParser</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>a_parser</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
destroy a xml parser 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>a_parser</em>&nbsp;</td><td>is a parser created using MXMLParserCreate </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga7" doxytag="mxml.h::MXMLParserParse" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> MXMLResult MXMLParserParse           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_m_x_m_l_parser.html">MXMLParser</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>a_parser</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>const unsigned char *&nbsp;</td>
          <td class="mdname" nowrap> <em>a_buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>a_bufferSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>a_lastBuffer</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse function 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>a_parser</em>&nbsp;</td><td>is a <a class="el" href="struct_m_x_m_l_parser.html">MXMLParser</a> created with MXMLParserCreate </td></tr>
    <tr><td></td><td valign=top><em>a_buffer</em>&nbsp;</td><td>is the current input buffer (UTF8) of size a_bufferSize, and may be a portion of a larger stream </td></tr>
    <tr><td></td><td valign=top><em>a_bufferSize</em>&nbsp;</td><td>is the current buffer size in bytes </td></tr>
    <tr><td></td><td valign=top><em>a_lastBuffer</em>&nbsp;</td><td>is set to 1 if this is the last input buffer </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>xml parsing result</dd></dl>
Below is an example usage of the <a class="el" href="struct_m_x_m_l_parser.html">MXMLParser</a>:<p>
<div class="fragment"><pre>

  static void StartElement(void *userData, const char *name, const char **atts)
  {
    printf("&lt;name=%s ", name);
    for(int i = 0; atts[i]; i += 2)
    {
      const char * name = atts[i];
      const char * value = atts[i+1];
      printf(", %s = %s", name, value);
    }
    printf("&gt;\n");
  }

  static void EndElement(void *userData, const char *name)
  {
    printf("&lt;/%s&gt;\n", name);
  }

  static void CharacterData(void *userData, const char *s, size_t len, MXMLCharacterDataType a_type)
  {
    printf("%s\n", s);
  }

  static int Load(FILE * f)
  {
    unsigned char buf[8192];
    MXMLParser * parser = MXMLParserCreate(malloc, free);
    int done;

    parser-&gt;m_userData = NULL;
    parser-&gt;m_StartElementCallback = StartElement;
    parser-&gt;m_EndElementCallback = EndElement;
    parser-&gt;m_CharacterDataCallback = CharacterData;

    do 
    {
      size_t len = fread(buf, 1, sizeof(buf), f);
      done = len &lt; sizeof(buf);
      if (MXMLParserParse(parser, buf, len, done) == MXML_RESULT_ERROR) 
      {
        MXMLParserGetErrorString(parser);
        MXMLParserDestroy(parser);
        return -1;
      }
    } while (!done);

    MXMLParserDestroy(parser);
    return 0;
  }

  </pre></div>    </td>
  </tr>
</table>
</div>
<div class="footer">
<div style="height:62px; width: 100%; background-image: url(images/mxml_footer_bg.jpg); background-repeat:no-repeat;">
  <br/>
  &nbsp; &nbsp;  Generated on Wed Jan 18 20:45:39 2006 for Micro XML &nbsp; &nbsp; <br/>
  &nbsp; &nbsp; copyright © 2003 Matthew Riek. &nbsp; &nbsp;
</div>
</div>
</body>
</html>
